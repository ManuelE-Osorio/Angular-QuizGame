<div class="margin">

@if(form != null) {
  <div class="field-container">
    <h2>Question Details</h2>
  </div>
  <form [formGroup]="form">
    
    <div class="field-container">
      <mat-form-field appearance="fill" class="big-field">
          <mat-label>Question:</mat-label>
          <textarea matInput formControlName="questionText"> </textarea>
      </mat-form-field>
    
    </div>

    <div class="field-container">
      <mat-form-field appearance="fill" class="field">
        <mat-label>Question Image:</mat-label>
        <input type="url" matInput formControlName="questionImage">
      </mat-form-field>

      <mat-form-field appearance="fill" class="field">
        <mat-label>Timeout:</mat-label>
        <input type="number" matInput formControlName="secondsTimeout">
      </mat-form-field>
    </div>

    <div class="field-container">
      <mat-form-field appearance="fill" class="field">
          <mat-label>Relative Score:</mat-label>
          <input type="number" matInput formControlName="relativeScore">
      </mat-form-field>

      <mat-form-field appearance="fill" class="field">
        <mat-label>Category:</mat-label>
        <input type="text" matInput formControlName="category">
      </mat-form-field>
    </div>

    <div class="field-container">
      <h3>Answer</h3>
    </div>

    <div [formGroup]="form.controls.correctAnswer" class="field-container">

      <mat-form-field appearance="fill" class="field">
        <mat-label>Text:</mat-label>
        <input type="text" matInput formControlName="answerText">
      </mat-form-field>

      <mat-form-field appearance="fill" class="field">
        <mat-label>Image:</mat-label>
        <input type="text" matInput formControlName="answerImage">
      </mat-form-field>
    </div>

    <div class="field-container">
      <h3>Wrong Answers</h3>
      <span class="spacer"></span>
      <button mat-mini-fab color="warn" (click)="removeWrongAnswer()" class="field-button">
        <mat-icon>remove</mat-icon>
      </button>
      <button mat-mini-fab color="primary" (click)="addWrongAnswer()" class="field-button">
        <mat-icon>add</mat-icon>
      </button>
    </div>

      @for (answer of form.controls.incorrectAnswers.controls; track $index) {
        <div [formGroup]="answer" class="field-container">
          <h4>{{$index + 1}})</h4>
        <mat-form-field appearance="fill" class="field">
          <mat-label>Text:</mat-label>
          <input type="text" matInput formControlName="answerText">
        </mat-form-field>
        <mat-form-field appearance="fill" class="field">
          <mat-label>Image:</mat-label>
          <input type="text" matInput formControlName="answerImage">
        </mat-form-field>
        </div> 
      }
    

    @if(!updateSuccessful) {
      <mat-error >{{errorMessage}}</mat-error>
    }
  
  </form>  

  <div class="field-container">
    <button mat-flat-button color="accent" class="field-button" (click)="return()">Return</button>
    @if(this.id == 0){
      <button mat-flat-button color="primary" [disabled]="!form.valid" (click)="submitForm()" class="field-button">Create</button>  
    }
    @else {
      <button mat-flat-button color="primary" [disabled]="!form.valid" (click)="submitForm()" class="field-button">Save Changes</button>  
    }
    <span class="spacer"></span>
  <button mat-flat-button color="warn" (click)="deleteQuestionDialog()" class="field-button">Delete</button>
  </div>
}
@else {
  <mat-spinner mode="indeterminate"></mat-spinner>
}


</div>


  


